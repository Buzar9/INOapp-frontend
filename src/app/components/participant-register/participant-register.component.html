<div class="main-screen">
  <!-- Ekran instrukcji - domyślny widok -->
  <div *ngIf="!showScanner && !showForm && !isLoading" class="instructions-section">    
    <div class="instruction-content">
      <h2>Przed rozpoczęciem</h2>
      <p>Udaj się do organizatora zawodów po kod QR. Kod zawiera informacje kategorii w jakiej bierzesz udział.</p>
    </div>
    
    <div class="button-container">
      <button pButton label="Zeskanuj kod QR" (click)="toggleScanner()" class="scan-button"></button>
    </div>
  </div>

  <!-- Ekran skanera -->
  <div *ngIf="showScanner" class="scanner-section">
    <div class="scanner-header">
      <h2>Zeskanuj kod QR</h2>
      <p>Skieruj kamerę na kod QR otrzymany od organizatora</p>
    </div>
    <qr-scanner [downloadImage]="false" (qrCodeScanned)="receiveInitScan($event)" (close)="toggleScanner()"></qr-scanner>
  </div>

  <!-- Formularz z pseudonimem -->
  <div *ngIf="showForm && !isLoading" class="form-section">
    <div class="form-header">
      <h2>Prawie gotowe!</h2>
      <p>Wpisz swój pseudonim i rozpocznij bieg</p>
    </div>
    
    <form [formGroup]="participantForm" (ngSubmit)="onSubmit()">
      <div class="input-container">
        <input type="text" pInputText formControlName="participantName" placeholder="Twój pseudonim" class="participant-input" [ngClass]="{'ng-invalid ng-dirty': participantForm.get('participantName')?.invalid && participantForm.get('participantName')?.touched}"/>
        <small *ngIf="participantForm.get('participantName')?.invalid && participantForm.get('participantName')?.touched" class="error-message">Pseudonim jest wymagany</small>
      </div>
      <div class="button-container">
        <button pButton type="submit" [disabled]="participantForm.invalid || isLoading" class="start-button">
          <span>Rozpocznij bieg</span>
        </button>
      </div>
    </form>
  </div>

  <!-- Loading indicator -->
  <div *ngIf="isLoading" class="loading-section">
    <div class="loading-content">
      <p-progressSpinner styleClass="custom-spinner" strokeWidth="4"></p-progressSpinner>
      <h2>Przygotowujemy mapę...</h2>
      <p>Trwa pobieranie danych o trasie, proszę czekać</p>
    </div>
  </div>
</div>