<div class="p-fluid grid">
  <div class="col-12 md:col-6">
    <label for="mapId">ID mapy (klucz w IndexedDB)</label>
    <input id="mapId" pInputText [(ngModel)]="mapId" placeholder="np. 3857_moja_mapa" />
  </div>

  <div class="col-12 flex gap-2 flex-wrap">
    <button pButton type="button" label="Wybierz folder (File System Access)"
            icon="pi pi-folder-open" (click)="pickDirectory()" [disabled]="busy"></button>

    <button pButton type="button" label="Wybierz folder (fallback)"
            icon="pi pi-folder" (click)="dirInput.click()" [disabled]="busy"></button>

    <!-- Natywny input z atrybutem webkitdirectory -->
    <input
      #dirInput
      type="file"
      style="display:none"
      (change)="onDirInputChange($event)"
      accept="image/png,image/jpeg,image/webp"
      multiple
      webkitdirectory
      directory
      mozdirectory
    />

    <button pButton type="button" label="Wyczyść kafelki tej mapy"
            icon="pi pi-trash" class="p-button-danger"
            (click)="clearMap()" [disabled]="busy || !mapId"></button>
  </div>

  <div class="col-12" *ngIf="progress.total > 0">
    <div class="mb-1">
      Import: {{progress.imported}} / {{progress.total}}
      (pomin.: {{progress.skipped}}, błędy: {{progress.errors}})
    </div>
    <p-progressBar [value]="progressPercent"></p-progressBar>
    <div class="mt-2" *ngIf="progress.step">{{progress.step}}</div>
  </div>

  <div class="col-12" *ngIf="statusMessage">
    <p>{{ statusMessage }}</p>
  </div>
</div>